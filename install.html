<!DOCTYPE html>
<html lang="he" dir="rtl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>×”×ª×§× ×ª ××¤×œ×™×§×¦×™×™×ª ×ª×—× ×•×ª ×’×¤"×</title>

    <!-- Meta tags from index.html -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="×ª×—× ×•×ª ×’×¤×´×">
    <meta name="theme-color" content="#2e7d32">

    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <link rel="manifest" href="manifest.json">
    <link rel="stylesheet" href="style.css">

    <style>
        body {
            font-family: system-ui, -apple-system, sans-serif;
            background-color: #f5f5f5;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
            text-align: center;
        }

        .container {
            background: white;
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            max-width: 400px;
            width: 100%;
        }

        img.logo {
            width: 120px;
            height: 120px;
            margin-bottom: 20px;
            border-radius: 24px;
        }

        h1 {
            color: #2e7d32;
            margin: 0 0 10px 0;
            font-size: 24px;
        }

        p.description {
            color: #666;
            margin-bottom: 30px;
            line-height: 1.5;
        }

        /* Override button styles from style.css to be inline */
        .ios-add-to-home,
        .android-install,
        .pwa-install {
            position: static !important;
            display: none;
            /* Will be shown by JS */
            width: 100%;
            justify-content: center;
            margin-bottom: 15px;
            padding: 16px !important;
            font-size: 16px !important;
            transform: none !important;
        }

        /* Ensure flex display when visible */
        .ios-add-to-home[style*="display: flex"],
        .android-install[style*="display: flex"],
        .pwa-install[style*="display: flex"] {
            display: flex !important;
        }

        .success-message {
            display: none;
            color: #2e7d32;
            background: #e8f5e9;
            padding: 15px;
            border-radius: 8px;
            font-weight: 500;
        }

        /* Reuse instructions styling from style.css but ensure it works here */
        .add-to-home-instructions {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 90%;
            max-width: 320px;
        }
    </style>
</head>

<body data-force-install="true">

    <div class="container">
        <img src="icons/icon-512.png" alt="×œ×•×’×• ×ª×—× ×•×ª ×’×¤×´×" class="logo">
        <h1>×ª×—× ×•×ª ×’×¤"×</h1>
        <p class="description">
            ×”×ª×§×Ÿ ××ª ×”××¤×œ×™×§×¦×™×” ×œ×”××©×š ×”×©×™××•×© ×‘×’×¨×¡× ×¢× ×”×¢×™×¦×•×‘ ×”×™×©×Ÿ
        </p>

        <!-- Install Buttons -->
        <button id="pwa-install" class="pwa-install" onclick="installPWA()">
            <span class="icon">âš¡</span>
            ×”×ª×§×Ÿ ××¤×œ×™×§×¦×™×”
        </button>



        <button id="ios-add-to-home" class="ios-add-to-home" onclick="showAddToHomeInstructions()">
            <span class="icon">ğŸ“±</span>
            ×”×•×¡×£ ×œ××¡×š ×”×‘×™×ª
        </button>

        <div id="already-installed" class="success-message">
            âœ… ×”××¤×œ×™×§×¦×™×” ×›×‘×¨ ××•×ª×§× ×ª ×¢×œ ×”××›×©×™×¨ ×©×œ×š
        </div>
    </div>

    <!-- PWA Install Instructions Overlay (copied from index.html structure) -->
    <div class="overlay" id="overlay"></div>
    <div class="add-to-home-instructions" id="add-to-home-instructions" style="display: none;">
        <h3>×”×•×¡×£ ×œ××¡×š ×”×‘×™×ª</h3>
        <p>1. ×œ×—×¥ ×¢×œ ×›×¤×ª×•×¨ ×”×©×™×ª×•×£
            <img src="https://raw.githubusercontent.com/guzsbhtk/lpg-stations/refs/heads/main/icons/share.jpeg"
                alt="×›×¤×ª×•×¨ ×©×™×ª×•×£"
                style="display: inline-block; vertical-align: middle; margin: 0 4px; width: 24px; height: 24px; border-radius: 4px;">
        </p>
        <p>2. ×‘×—×¨ "×”×•×¡×£ ×œ××¡×š ×”×‘×™×ª" ××• "Add to Home Screen"</p>
        <p>3. ×œ×—×¥ ×¢×œ "×”×•×¡×£" ××• "Add"</p>
        <div style="display: flex; gap: 10px; justify-content: center; margin-top: 15px;">
            <button onclick="hideAddToHomeInstructions()"
                style="background: #007AFF; flex: 1; color: white; border: none; padding: 10px; border-radius: 6px;">×”×‘× ×ª×™</button>
        </div>
    </div>

    <!-- Scripts -->
    <script src="js/constants.js"></script>
    <script src="js/utils.js"></script>
    <script src="js/device-detection.js"></script>

    <!-- Inline script to mock missing UI dependencies if needed or just load pwa-install.js -->
    <script>
        // Mock UI functions if pwa-install.js relies on them and they aren't loaded
        // However, looking at pwa-install.js, it seems self-contained mostly, accessing DOM elements we provided.
        // It might use some global state, let's load it and see.
    </script>

    <script src="js/pwa-install.js"></script>

    <script>
        // Register service worker to enable beforeinstallprompt event
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('service-worker.js')
                .then(() => console.log('Service Worker registered successfully'))
                .catch(err => console.error('Service Worker registration failed:', err));
        }
    </script>

    <script>
        // Initialize install buttons logic
        document.addEventListener('DOMContentLoaded', () => {
            // Don't show the PWA install button immediately - wait for beforeinstallprompt event
            // The pwa-install.js will handle showing it when appropriate

            // Check if we're on iOS and should show the iOS button instead
            if (typeof isIOS === 'function' && typeof isMobile === 'function' && typeof isStandalone === 'function') {
                if (isMobile() && isIOS() && !isStandalone()) {
                    const iosBtn = document.getElementById('ios-add-to-home');
                    if (iosBtn) iosBtn.style.display = 'flex';
                }
            }

            // On the install page, manually trigger the PWA button display after a short delay
            // This allows the beforeinstallprompt event to fire first if available
            setTimeout(() => {
                if (typeof showPWAInstallButton === 'function') {
                    showPWAInstallButton();
                }
            }, 500);
        });
    </script>
</body>

</html>